---
title: "New York cabs"
author: "Katerina Dimitrova, Jose Romero, Sergi Munoz"
date: "March 18, 2018"
output: pdf_document
---

```{r,include=FALSE}
#knitr::opts_chunk$set(echo = TRUE)

```
```{r,include=FALSE}
setwd("C:/Users/Sergi/Desktop/Sergi/ADEI/") #Change 


```
#Previous work

## Load requiered packages

```{r, echo=FALSE, include=FALSE}
rm(list=ls())

requiredPackages <- c("effects","FactoMineR","car", "factoextra","RColorBrewer","ggplot2","missMDA","mvoutlier","dplyr","caret", "ggmap","ggthemes","knitr","MVA", "ROCR")
missingPackages <- requiredPackages[!(requiredPackages %in% installed.packages()[,"Package"])]

if(length(missingPackages)) install.packages(missingPackages)
lapply(requiredPackages, require, character.only = TRUE)

```
## Select 5000 samples

We generate a sample from a random seed (Sergi's birthday) and store it in df var. Since we have already done it before and we don't want to risk that some random effect could have any impact on our data generation, we will just load the initial data raw (without any previous pre-processing execution)
```{r}
#Load samples
#df<-read.table("green_tripdata_2016-01.csv",header=T, sep=",")
#set.seed(03101994)
#sam<-as.vector(sort(sample(1:nrow(df),5000)))
#df<-df[sam,]
load("C:/Users/Sergi/Desktop/Sergi/ADEI/Taxi5000_raw_initial.RData")
```

##Load usefull functions

```{r}

# Useful function
calcQ <- function(x) {
  s.x <- summary(x)
  iqr<-s.x[5]-s.x[2]
  list(souti=s.x[2]-3*iqr, mouti=s.x[2]-1.5*iqr, min=s.x[1], q1=s.x[2], q2=s.x[3],        q3=s.x[5], max=s.x[6], mouts=s.x[5]+1.5*iqr, souts=s.x[5]+3*iqr ) 
}


countX <- function(x,X) {
  n_x <- NULL
  for (j in 1:ncol(x)) {n_x[j] <- sum(x[,j]==X) }
  n_x <- as.data.frame(n_x)
  rownames(n_x) <- names(x)
  nx_i <- rep(0,nrow(x))
  for (j in 1:ncol(x)) {nx_i <- nx_i + as.numeric(x[,j]==X) }
  list(nx_col=n_x,nx_ind=nx_i) }

countNA <- function(x) {
  mis_x <- NULL
  for (j in 1:ncol(x)) {mis_x[j] <- sum(is.na(x[,j])) }
  mis_x <- as.data.frame(mis_x)
  rownames(mis_x) <- names(x)
  mis_i <- rep(0,nrow(x))
  for (j in 1:ncol(x)) {mis_i <- mis_i + as.numeric(is.na(x[,j])) }
  list(mis_col=mis_x,mis_ind=mis_i) }

man.dist.manual <- function(p1Lat, p1Lon, p2Lat, p2Lon) {
  #return(abs(pointDistance(c(p1$lon, p1$lat), c(p1$lon, p2$lat), longlat=TRUE)) + abs(pointDistance(c(p2$lon, p1$lat), c(p2$lon, p2$lat), longlat=TRUE)))
  R = 6371
  lat1 = degrees.to.radians(p1Lat)
  lon1 = degrees.to.radians(p1Lon)
  lat2 = degrees.to.radians(p2Lat)
  lon2 = degrees.to.radians(p2Lon)
  A_lat = lat2 - lat1
  A_lon = lon2 - lon1
  a = sin(A_lat/2)^2
  c = 2 * atan2(sqrt(a), sqrt(1-a))
  dist_lat = R * c
  a = sin(A_lon/2)^2
  c = 2 * atan2(sqrt(a), sqrt(1-a))
  dist_lon = R * c
  abs(dist_lat) + abs(dist_lon)
  return(abs(dist_lat) + abs(dist_lon))
}

degrees.to.radians<-function(value) {
  return(value*0.0174532925)
}

```


## Delete unnecessary attributes
```{r}
table(df$Ehail_fee) ##Delete unnecessary row
df$Ehail_fee<-NULL

```

#Conversion of qualitative variables

Numeric variables corresponding to qualitative concepts are converted to factors.
We also 

## VendorID
```{r}
#No missing Data
missingData<-which(is.na(df$VendorID));length(missingData) 
df$VendorID<-factor(df$VendorID,labels=c("Creative Mobile Technologies, LLC","VeriFone Inc."))
table(df$VendorID)
barplot(prop.table(table(df$VendorID)))
```

## RateCodeID
```{r}
#No missing Data
missingData<-which(is.na(df$RateCodeID));length(missingData) 
df$RateCodeID<-factor(df$RateCodeID,labels=c("Standard rate","JFK","Newark","Nassau or Westchester","Negotiated fare"))
levels(df$RateCodeID)[levels(df$RateCodeID)=="Newark"] <- "Special rate"
levels(df$RateCodeID)[levels(df$RateCodeID)=="Nassau or Westchester"] <- "Special rate"
levels(df$RateCodeID)[levels(df$RateCodeID)=="Negotiated fare"] <- "Special rate"
levels(df$RateCodeID)[levels(df$RateCodeID)=="JFK"] <- "Special rate"
table(df$RateCodeID) 
barplot(prop.table(table(df$RateCodeID)))
```

## Store_and_fwd_flag 
```{r}
#No missing Data
missingData<-which(is.na(df$Store_and_fwd_flag));length(missingData) 
df$Store_and_fwd_flag<-factor(df$Store_and_fwd_flag,labels=c("not a store and forward trip","store and forward trip"))
levels(df$Store_and_fwd_flag) <- c("Store_and_fwd","Not_Store_and_fwd")
table(df$Store_and_fwd_flag)
barplot(prop.table(table(df$Store_and_fwd_flag)))
```

## Payment_type 
```{r}
#No missing Data
missingData<-which(is.na(df$Trip_type));length(missingData) 
df$Payment_type<-factor(df$Payment_type,labels=c("Credit card","Cash", "No charge", "Dispute"))
levels(df$Payment_type)[levels(df$Payment_type)=="No charge"] <- "Other"
levels(df$Payment_type)[levels(df$Payment_type)=="Dispute"] <- "Other"
table(df$Payment_type)
barplot(prop.table(table(df$Payment_type)))
```

## Trip_type
```{r}
#No missing Data
missingData<-which(is.na(df$Trip_type));length(missingData) 
df$Trip_type<-factor(df$Trip_type,labels=c("Street-hail","Dispatch"))
table(df$Trip_type)
barplot(prop.table(table(df$Trip_type)))
```


# Univariant Descriptive Analysis 
## Passenger_count
```{r}
## Number of missing values:
missingData<-which(is.na(df$Passenger_count));length(missingData) #No missing Data
errors<-which(df$Passenger_count<=0.0);length(errors) #2 errors
outliers<-which(df$Passenger_count>6.0);length(outliers) #0 outlier
df[errors,"Passenger_count"]<-NA
df[outliers,"Passenger_count"]<-NA
boxplot(df$Passenger_count)
barplot(table(df$Passenger_count))
```

## Trip_distance

We distinguish as an outlier for Trip_distance those elements which value over 20, since we believe it is big enough to our study case and we can not be too severes applying Interquartile Range (we keep a long right queue distribution).
```{r} 
missingData<-which(is.na(df$Trip_distance));length(missingData) #No missing Data
errors<-which(df$Trip_distance<=0.0);length(errors) #59 errors

outliers <- which(df$Trip_distance>20.0);length(outliers) #17 outlier

df[outliers,"Trip_distance"]<-NA 
df[errors,"Trip_distance"]<-NA 
boxplot(df$Trip_distance)
hist(df$Trip_distance, col="pink")
summary(df$Trip_distance)
```

## Pickup_longitude
```{r}
missingData<-which(is.na(df$Trip_distance));length(missingData) #No missing Data

#min and max longitudes for New York city boundaries
min_long <- -74.15 
max_long <- -73.7004

errors<-which(df$Pickup_longitude< min_long);length(errors)
errors<-c(errors,which(df$Pickup_longitude> max_long));length(errors)
errors<-c(errors,which(df$Pickup_longitude==0.0));length(errors)
df[errors,"Pickup_longitude"]<-NA

ll<-which(is.na(df$Pickup_longitude));ll
if(length(ll)>0){
  dfaux<-df[-ll,]
}

iqrvar<-IQR(dfaux$Pickup_longitude)
quantil3<-quantile(dfaux$Pickup_longitude, .75);quantil3 #get 3rd quartile
quantil1<-quantile(dfaux$Pickup_longitude, .25);quantil1 #get 1st quartile

UpperOutlier<-which(df$Pickup_longitude>quantil3+(iqrvar*3));length(UpperOutlier) #14 extreme UpperOutliers
LowerOutlier<-which(df$Pickup_longitude<quantil1-(iqrvar*3));length(LowerOutlier) #1 extreme LowerOutliers


df[UpperOutlier,"Pickup_longitude"]<-NA 
df[LowerOutlier,"Pickup_longitude"]<-NA 
boxplot(df$Pickup_longitude)
summary(df$Pickup_longitude)
```

## Pickup_latitude
```{r}
missingData<-which(is.na(df$Pickup_latitude));length(missingData) #No missing Data

#we need to add here error control (what if longitude is out of scope?) and outlier management

summary(df$Pickup_latitude)

#min and max latitudes for New York city boundaries
min_lat <- 40.5774
max_lat <- 40.9176

errors<-which(df$Pickup_latitude< min_lat);length(errors)
errors<-c(errors,which(df$Pickup_latitude> max_lat));length(errors)
errors<-c(errors,which(df$Pickup_latitude==0.0));length(errors)
df[errors,"Pickup_latitude"]<-NA #17 errors

ll<-which(is.na(df$Pickup_latitude));ll
if(length(ll)>0){
  dfaux<-df[-ll,]
}

iqrvar<-IQR(dfaux$Pickup_latitude)
quantil3<-quantile(dfaux$Pickup_latitude, .75);quantil3 #get 3rd quartile
quantil1<-quantile(dfaux$Pickup_latitude, .25);quantil1 #get 1st quartile

UpperOutlier<-which(df$Pickup_latitude>quantil3+(iqrvar*3));length(UpperOutlier) #0 extreme UpperOutliers
LowerOutlier<-which(df$Pickup_latitude<quantil1-(iqrvar*3));length(LowerOutlier) #0 extreme LowerOutliers
df[UpperOutlier,"Pickup_latitude"]<-NA 
df[LowerOutlier,"Pickup_latitude"]<-NA 
boxplot(df$Pickup_latitude)
summary(df$Pickup_latitude)
```

##Dropoff_longitude
```{r}
missingData<-which(is.na(df$Dropoff_longitude));length(missingData) #No missing Data

errors<-c(errors,which(df$Dropoff_longitude==0.0));length(errors) #26 errors
df[errors,"Dropoff_longitude"]<-NA

ll<-which(is.na(df$Dropoff_longitude));ll
if(length(ll)>0){
  dfaux<-df[-ll,]
}

iqrvar<-IQR(dfaux$Dropoff_longitude)
quantil3<-quantile(dfaux$Dropoff_longitude, .75);quantil3 #get 3rd quartile
quantil1<-quantile(dfaux$Dropoff_longitude, .25);quantil1 #get 1st quartile

UpperOutlier<-which(df$Dropoff_longitude>quantil3+(iqrvar*3));length(UpperOutlier) #0 extreme UpperOutliers
LowerOutlier<-which(df$Dropoff_longitude<quantil1-(iqrvar*3));length(LowerOutlier) #0 extreme LowerOutliers
df[UpperOutlier,"Dropoff_longitude"]<-NA 
df[LowerOutlier,"Dropoff_longitude"]<-NA 

boxplot(df$Dropoff_longitude)
```

## Dropoff_latitude
```{r}
missingData<-which(is.na(df$Dropoff_latitude));length(missingData) #No missing Data

errors<-c(errors,which(df$Dropoff_latitude==0.0));length(errors) #35 errors
df[errors,"Dropoff_latitude"]<-NA

ll<-which(is.na(df$Dropoff_latitude));ll
if(length(ll)>0){
  dfaux<-df[-ll,]
}

iqrvar<-IQR(dfaux$Dropoff_latitude)
quantil3<-quantile(dfaux$Dropoff_latitude, .75);quantil3 #get 3rd quartile
quantil1<-quantile(dfaux$Dropoff_latitude, .25);quantil1 #get 1st quartile

UpperOutlier<-which(df$Dropoff_latitude>quantil3+(iqrvar*3));length(UpperOutlier) #0 extreme UpperOutliers
LowerOutlier<-which(df$Dropoff_latitude<quantil1-(iqrvar*3));length(LowerOutlier) #0 extreme LowerOutliers
df[UpperOutlier,"Dropoff_latitude"]<-NA 
df[LowerOutlier,"Dropoff_latitude"]<-NA 

boxplot(df$Dropoff_latitude)
```

## Fare_amount

We distinguish as an outlier for Fare_amount those elements which value over 60, since we believe it is big enough to our study case and we can not be too severes applying Interquartile Range (we keep a long right queue distribution).
```{r}
missingData<-which(is.na(df$Fare_amount));length(missingData) #No missing Data
#23 errors
sel<-which(df$Fare_amount<=0.0);length(sel) 
#21 outlier
outlier<-which(df$Fare_amount>60);length(outlier) 
df[sel,"Fare_amount"]<-NA 
df[outlier,"Fare_amount"]<-NA 
boxplot(df$Fare_amount)
hist(df$Fare_amount, col="pink")
summary(df$Fare_amount)
```

## Extra 

```{r}
missingData<-which(is.na(df$Extra));length(missingData) #No missing Data

sel<-which(df$Extra<0.0);length(sel) #4 error
df[sel,"Extra"]<-NA 
boxplot(df$Extra)
hist(df$Extra, col="pink")
```

## MTA_tax
```{r}
missingData<-which(is.na(df$MTA_tax));length(missingData) #No missing Data

sel<-which(df$MTA_tax<0.0);length(sel) #10 error
df[sel,"MTA_tax"]<-NA
boxplot(df$MTA_tax)
hist(df$MTA_tax, col="pink")
```

## Improvement_surcharge
```{r}
missingData<-which(is.na(df$improvement_surcharge));length(missingData) #No missing Data

sel<-which(df$improvement_surcharge<0.0);length(sel) #10 errors
df[sel,"improvement_surcharge"]<-NA
boxplot(df$improvement_surcharge)
hist(df$improvement_surcharge, col="pink")
```

##Tip_amount

We distinguish as an outlier for Tip_amount those elements which value over 25, since we believe it is big enough to our study case and we can not be too severes applying Interquartile Range (we keep a long right queue distribution).
```{r}
missingData<-which(is.na(df$Tip_amount));length(missingData) #No missing Data

sel<-which(df$Tip_amount<0.0);length(sel) #1 error
outlier<-which(df$Tip_amount>25.0);length(outlier) #8 outliers
df[outlier,"Tip_amount"]<-NA
df[sel,"Tip_amount"]<-NA
boxplot(df$Tip_amount)
hist(df$Tip_amount, col="pink")
```

##Tolls_amount

We don't get rid of any row for this variable because of its own nature. We are lack of criteria to detect what would be an outlier and it does not seem to achieve very high values in its distribution (histogram plot).
```{r}
missingData<-which(is.na(df$Tolls_amount));length(missingData) #No missing Data

sel<-which(df$Tolls_amount<0.0);length(sel) #0 errors
df[sel,"Tolls_amount"]<-NA
boxplot(df$Tolls_amount)
hist(df$Tolls_amount, col="pink")
summary(df$Tolls_amount)
```

##Total_amount (Target)
```{r}
missingData<-which(is.na(df$Total_amount));length(missingData) #No missing Data
sel<-which(df$Total_amount<=0.0);length(sel) #23 errors
df[sel,"Total_amount"]<-NA 

hist(df$Total_amount, col="pink")
iqrvar<-IQR(dfaux$Total_amount)
quantil3<-quantile(dfaux$Total_amount, .75) #get 3rd quartile
severePoint<-(iqrvar*3)+quantil3; severePoint; #it's too severe, we won't use this method
outlier<- which(df$Total_amount>severePoint);length(outlier) #111 extreme outliers

outlier<- which(df$Total_amount>70);length(outlier) #30 extreme outliers
df[outlier,"Total_amount"]<-NA 
boxplot(df$Total_amount)
hist(df$Total_amount, col="pink")
```

# Number of missing values:
```{r}



mis1<-countNA(df)
attributes(mis1)
rank(mis1$mis_col)
df$mis_ind <- mis1$mis_ind # new attribute missing values
mis1$mis_col

```

# Creating AnyTip
```{r}

df$AnyTip<-ifelse(df$Tip_amount<0.0001,0,1) 
df$AnyTip<-factor(df$AnyTip,labels=paste("AnyTip",c("No","Yes")))

```


#Creating auxiliar variables and doing their analysis

## Trip length
```{r}
for (i in 1:nrow(df)){
  df$trip_length[i] <- man.dist.manual(df$Pickup_latitude[i],df$Pickup_longitude[i],df$Dropoff_latitude[i],df$Dropoff_longitude[i])
}

outlier <- which(df$trip_length<0.1);length(outlier) #No missing Data
df[outlier,"trip_length"]<-NA

summary(df$trip_length)
boxplot(df$trip_length)

```


## Trip distance in km
```{r}

df$trip_distance_km<-df$Trip_distance*1.609344 # Miles to km

summary(df$trip_distance_km)
boxplot(df$trip_distance_km)
```

## Travel time in minutes
```{r}
summary(df$lpep_pickup_datetime)
b1<-as.POSIXlt(df$lpep_pickup_datetime)
b2<-as.POSIXlt(df$Lpep_dropoff_datetime)
df$travel_time<-as.double(difftime(b2,b1,units='min'))
error<-which(df$travel_time< 1.0);length(error) #No errors
df[error,"travel_time"]<-NA 
outlier<-which(df$travel_time>400.0);length(outlier) #
df[outlier,"travel_time"]<-NA
summary(df$travel_time)
boxplot(df$travel_time)
```


## Pick_up_hour
```{r}
mydate <- as.POSIXlt(df$lpep_pickup_datetime)
df$pick_up_hour <- mydate$hour

summary(df$pick_up_hour)
boxplot(df$pick_up_hour)
```


## Pick_up_period
```{r}
# night, morning, valley and afternoon

df$pick_up_period= cut(df$pick_up_hour, breaks = c(-1, 5, 11, 17, 23), labels= c("night", "morning", "valley", "afternoon"))

summary(df$pick_up_period)

```


# Declaring vectors of data
```{r}
names(df)
vars_con<-names(df)[c(6:9, 11,12,15,16,23:25)] 
vars_con
vars_dis<-names(df)[c(1:5,13,14,17,10,26,27)]
vars_dis
vars_res<-names(df)[c(18,22)]
vars_res

```




# Correlations error variable


```{r}

library(FactoMineR)
names (df)
summary(df$mis_ind)
corV <- cor(df[,vars_con], df$mis_ind,  use = "complete.obs")
corV 
 # rank 
rank(corV) 


```


# Imputation

## Remove observations with NA at targets

We also delete passenger count NA row because...

```{r}

ll<-which(is.na(df$Passenger_count));ll
if(length(ll)>0){
  df<-df[-ll,]
}

ll<-which(is.na(df$Total_amount));ll
if(length(ll)>0){
  df<-df[-ll,]
}

ll<-which(is.na(df$AnyTip));ll
if(length(ll)>0){
  df<-df[-ll,]
}

```


## Imputation of numeric variables
```{r}

library(missMDA)
names(df)
res.comp <- imputePCA(df[,vars_con], ncp=4)
df[,"Pickup_longitude"]<-res.comp$completeObs[,"Pickup_longitude"]
df[,"Pickup_latitude"]<-res.comp$completeObs[,"Pickup_latitude"]
df[,"Dropoff_longitude"]<-res.comp$completeObs[,"Dropoff_longitude"]
df[,"Dropoff_latitude"]<-res.comp$completeObs[,"Dropoff_latitude"]
df[,"Trip_distance"]<-res.comp$completeObs[,"Trip_distance"]
df[,"trip_distance_km"]<-res.comp$completeObs[,"trip_distance_km"]
df[,"trip_length"]<-res.comp$completeObs[,"trip_length"]
df[,"Fare_amount"]<-res.comp$completeObs[,"Fare_amount"]
df[,"travel_time"]<- res.comp$completeObs[,"travel_time"]
df[,"Tip_amount"]<-res.comp$completeObs[,"Tip_amount"]
df[,"Tolls_amount"]<-res.comp$completeObs[,"Tolls_amount"]
summary(df)
```


## Espeed (km/h)
```{r}
#efective speed : trigonometric distance between pickup point and dropoff point divided by travel time 

for (i in 1:nrow(df)){
  df$espeed[i] <- df$trip_length[i]/(df$travel_time[i]/60)
}

summary(df$espeed)

outliers<-which(df$espeed>100.0);length(outliers) #0 outlier
df[outliers,"espeed"]<-NA
vars_con<-names(df)[c(6:9, 11,12,15,16,23:25,28)] 
vars_con
res.comp <- imputePCA(df[,vars_con], ncp=4)
df[,"espeed"]<- res.comp$completeObs[,"espeed"]
summary(df$espeed)
boxplot(df$espeed)

```


# Creating factors

## Factorize function:
```{r}
factorize<- function(x) {
  quantile(x,seq(0,1,0.1))
  pp<-quantile(x);pp
  breaks<-c(unique(pp))
  f.x<-factor(cut(x,breaks))
  return(f.x);
}
```

## f.passenger
```{r}

df$f.passenger<-factor(cut(df$Passenger_count,breaks=c(0,1,6)))
summary(df$f.passenger)

```

## f.distance
```{r}
df$f.distance<-factor(cut(df$Trip_distance,breaks=c(0,1.01,1.8,3.31,19.8)))
summary(df$f.distance) 
```

## f.pickup_longitude
```{r}
df$f.pickup_longitude<-factor(cut(df$Pickup_longitude,breaks=c(-74.1,-73.96,-73.947,-73.918,-73.79)))
summary(df$f.pickup_longitude)
```

## f.pickup_latitude
```{r}
df$f.pickup_latitude<-factor(cut(df$Pickup_latitude,breaks=c(40.5,40.695,40.744,40.8,40.92)))
summary(df$f.pickup_latitude)
```

## f.dropoff_longitude
```{r}
df$f.dropoff_longitude<-factor(cut(df$Dropoff_longitude,breaks=c(-74.1,-73.97,-73.945,-73.91,-73.75)))
summary(df$f.dropoff_longitude)

```

## f.dropoff_latitude
```{r}
df$f.dropoff_latitude<-factor(cut(df$Dropoff_latitude,breaks=c(40.53,40.7,40.75,40.79,41.5)))
summary(df$f.dropoff_latitude) 
```

## f.fare_amount
```{r}
df$f.fare_amount<-factor(cut(df$Fare_amount,breaks=c(0,6,9,14,60.5)))
summary(df$f.fare_amount)
```

## f.extra
```{r}
df$f.extra<-factor(cut(df$Extra,breaks=c(-0.1,0.5,2)))
summary(df$f.extra)
```

## f.MTA_tax
```{r}
df$f.MTA_tax<-factor(cut(df$MTA_tax,breaks=c(-0.1,0.4,0.5)))
summary(df$f.MTA_tax) #11 NA's -> values of -0.5 => Outliers?

```

## f.Improvement_surcharge
```{r}
df$f.Improvement_surcharge<-factor(cut(df$improvement_surcharge, breaks=c(-0.1,0.1,0.8)))
summary(df$f.Improvement_surcharge) #11 NA's -> values of -0.3 => Outliers?
```

## f.tip_amount
```{r}
df$f.tip_amount<-factor(cut(df$Tip_amount, breaks=c(-0.1,1,25.1)))
summary(df$f.tip_amount)
```

## f.tolls_amount
```{r}
df$f.toll<-factor(cut(df$Tolls_amount,breaks=c(-1,1,50)))
summary(df$f.toll)
```

## f.total_amount
```{r}
df$f.total<-factor(cut(df$Total_amount,breaks=c(-1,7.8,11,16.6,70.1)))
summary(df$f.total)
```

##f.ttime
```{r}
df$f.ttime<-factor(cut(df$travel_time,breaks=c(-1,6,9.78,15.7,415)))
summary(df$f.ttime)
```

##f.espeed
```{r}
df$f.espeed<-factor(cut(df$espeed,breaks=c(0.0,15.3,20.1,26.2,95)))
summary(df$f.espeed)
```

## Multivariant Outlier Detection

```{r}
library(mvoutlier)
names(df)
vars_con
summary(df[,vars_con])
vars_con_out<-vars_con[c(5,6,7,9)]
mvout<-aq.plot(df[,vars_con_out])
sum(mvout$outliers)
```


# Profiling
```{r}
library(FactoMineR)
# Numeric Target Total_Amount
summary(df$trip_length);
summary(df$espeed)
vars_dis
names(df)
vars_con_profiling <- c(vars_con,(names(df)[c(18)]))
#condes(df,1)
vars_con_profiling
condes(df[, vars_con_profiling], num.var=18)
summary(df$espeed)
# Binary Target AnyTip
vars_con;vars_dis
names(df)
vars_con_and_dis <- names(df)[c(1,4,5,10,19,20,22,27,6,7,8,9,11,12,13,14,15,16,17,23,24,25,26)] 
#if p.value is under 0.5 then we have to reject the hipothesis of no relation between variable and target
catdes(df[,vars_con_and_dis],num.var=7)
```








